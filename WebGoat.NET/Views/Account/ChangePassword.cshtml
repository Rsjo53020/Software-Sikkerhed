@model ChangePasswordViewModel
@using Microsoft.AspNetCore.Identity
@inject Microsoft.Extensions.Options.IOptions<IdentityOptions> IdentityOptions

@{
    ViewData["Title"] = "Change Password";
}
@{
    var pw = IdentityOptions.Value.Password;

    var requirements = new List<string>();

    if (pw.RequiredLength > 0)
        requirements.Add($"Minimum length: {pw.RequiredLength} characters");

    if (pw.RequireUppercase)
        requirements.Add("At least one uppercase letter (A–Z)");

    if (pw.RequireLowercase)
        requirements.Add("At least one lowercase letter (a–z)");

    if (pw.RequireDigit)
        requirements.Add("At least one number (0–9)");

    if (pw.RequireNonAlphanumeric)
        requirements.Add("At least one special character (!, @, #, etc.)");

    if (pw.RequiredUniqueChars > 1)
        requirements.Add($"At least {pw.RequiredUniqueChars} unique characters");
}

<h2>
    Change Password
</h2>
<p>
    Use the form below to change your password.
</p>
<p>
<ul>
    @foreach (var req in requirements)
    {
        <li>@req</li>
    }
</ul>
</p>
<span class="failureNotification">
    @Html.ValidationSummary()
</span>
@using (Html.BeginForm(FormMethod.Post))
{
    <div class="accountInfo">
        <fieldset class="changePassword">
            <legend>Account Information</legend>
            <p>
                @Html.LabelFor(m => m.OldPassword)
                @Html.PasswordFor(m => m.OldPassword)
            </p>
            <p>
                @Html.LabelFor(m => m.NewPassword)
                @Html.PasswordFor(m => m.NewPassword)
            </p>
            <p>
                @Html.LabelFor(m => m.ConfirmedNewPassword)
                @Html.PasswordFor(m => m.ConfirmedNewPassword)
            </p>
        </fieldset>
        <p class="submitButton">
            <input type="submit" value="Change Password" />
        </p>
    </div>
}